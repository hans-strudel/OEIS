{"formerly":"","seq":"1,0,2,0,4,2,2,10,10,2,14,40,48,16,2,90,230,256,120,22,2,646,1580,1670,888,226,28,2,5242,12434,12846,7198,2198,366,34,2,47622,110320,112820,64968,22120,4448,540,40,2,479306,1090270,1108612,650644,236968,54304,7900,748,46,2","description":"Triangle read by rows: T(n,k) = number of permutations of length n with exactly k rising or falling successions, for n >= 1, 0 <= k <= n-1.","comments":"Number of permutations of 12...n such that exactly k of the following occur: 12, 23, ..., (n-1)n, 21, 32, ..., n(n-1).","references":["F. N. David, M. G. Kendall and D. E. Barton, Symmetric Function and Allied Tables, Cambridge, 1966, p. 263.","J. Riordan, A recurrence for permutations without rising or falling successions. Ann. Math. Statist. 36 (1965), 708-710.","David Sankoff and Lani Haque, Power Boosts for Cluster Tests, in Comparative Genomics, Lecture Notes in Computer Science, Volume 3678/2005, Springer-Verlag. [Added by _N. J. A. Sloane_, Jul 09 2009]"],"links":["Alois P. Heinz, <a href=\"/A001100/b001100.txt\">Rows n = 1..141, flattened</a>"],"formula":"Let T{n, k} = number of permutations of 12...n with exactly k rising or falling successions. Let S[n](t) = Sum_{k >= 0} T{n, k}*t^k. Then S[0] = 1; S[1] = 1; S[2] = 2*t; S[3] = 4*t+2*t^2; for n >= 4, S[n] = (n+1-t)*S[n-1] - (1-t)*(n-2+3*t)*S[n-2] - (1-t)^2*(n-5+t)*S[n-3] + (1-t)^3*(n-3)*S[n-4].","example":"1;0, 2;0, 4, 2;2, 10, 10, 2;14, 40, 48, 16, 2;90, 230, 256, 120, 22, 2;646, 1580, 1670, 888, 226, 28, 2;","maple":"S:= proc(n) option remember; `if`(n<4, [1, 1, 2*t, 4*t+2*t^2]       [n+1], expand((n+1-t)*S(n-1) -(1-t)*(n-2+3*t)*S(n-2)       -(1-t)^2*(n-5+t)*S(n-3) +(1-t)^3*(n-3)*S(n-4)))    end:T:= (n, k)-> ceil(coeff(S(n), t, k)):seq(seq(T(n, k), k=0..n-1), n=1..10);  # _Alois P. Heinz_, Jan 11 2013","mathematica":"s[n_] := s[n] = If[n < 4, {1, 1, 2*t, 4*t + 2*t^2}[[n + 1]], Expand[(n + 1 - t)*s[n - 1] - (1 - t)*(n - 2 + 3*t)*s[n - 2] - (1 - t)^2*(n - 5 + t)*s[n - 3] + (1 - t)^3*(n - 3)* s[n - 4]]]; t[n_, k_] := Ceiling[Coefficient[s[n], t, k]]; Flatten[ Table[ Table[t[n, k], {k, 0, n - 1}], {n, 1, 10}]] (* _Jean-FranÃ§ois Alcover_, Jan 25 2013, translated from _Alois P. Heinz_'s Maple program *)","crossrefs":["Diagonals give A002464, A086852, A086853, A086854, A086955.","Triangle in A086856 multiplied by 2. Cf. A010028."],"keyword":"tabl,nonn","offset":"1,3","author":"_N. J. A. Sloane_, Aug 19 2003"}