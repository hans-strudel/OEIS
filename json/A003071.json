{"formerly":"M2443","seq":"0,1,3,5,9,11,14,17,25,27,30,33,38,41,45,49,65,67,70,73,78,81,85,89,98,101,105,109,115,119,124,129,161,163,166,169,174,177,181,185,194,197,201,205,211,215,220,225,242,245,249,253,259,263,268,273,283,287,292,297,304","description":"Sorting numbers: maximal number of comparisons for sorting n elements by list merging.","comments":"Comment from Jeremy Gardiner, Dec 28 2008: The following sequences all appear to have the same parity: A003071, A029886, A061297, A092524, A093431, A102393, A104258, A122248, A128975.a(A092246(n)) = A230720(n); a(A230709(n)) = A230721(n+1). - _Reinhard Zumkeller_, Oct 28 2013","references":["J.-P. Allouche and J. Shallit, The ring of k-regular sequences, Theoretical Computer Sci., 98 (1992), 163-197.","D. E. Knuth, Art of Computer Programming, Vol. 3, Sections 5.2.4 and 5.3.1.","N. J. A. Sloane and Simon Plouffe, The Encyclopedia of Integer Sequences, Academic Press, 1995 (includes this sequence)."],"links":["Moshe Levin, <a href=\"/A003071/b003071.txt\">Table of n, a(n) for n = 1..10000</a>","J.-P. Allouche and J. Shallit, <a href=\"http://www.cs.uwaterloo.ca/~shallit/Papers/as0.ps\">The ring of k-regular sequences</a>, Theoretical Computer Sci., 98 (1992), 163-197.","Tanya Khovanova, <a href=\"http://arxiv.org/abs/1410.2193\">There are no coincidences</a>, arXiv preprint 1410.2193, 2014","<a href=\"/index/So#sorting\">Index entries for sequences related to sorting</a>"],"formula":"Let n = 2^e_1 + 2^e_2 + ... + 2^e_t, e_1 > e_2 > ... > e_t >= 0, t >= 1. Then a(n) = 1 - 2^e_t + Sum_{1<=k<=t} (e_k+k-1)*2^e_k [Knuth, Problem 14, Section 5.2.4].a(n) = a(n-1) + A061338(n) = a(n-1) + A006519(n) + A000120(n)-1 = n + A000337(A000523(n)) + a(n-2^A000523(n)). a(2^k) = k*2^k + 1 = A002064(k). - _Henry Bottomley_, Apr 27 2001G.f.: x/(1-x)^3 + 1/(1-x)^2*Sum(k>=1, (-1+(1-x)*2^(k-1))*x^2^k/(1-x^2^k)). - _Ralf Stephan_, Apr 17 2003","mathematica":"a[1] = 0; a[n_] := a[n] = a[n-1] + 2^IntegerExponent[n-1, 2] + DigitCount[n-1, 2, 1] - 1; Table[a[n], {n, 1, 61}] (* _Jean-Fran√ßois Alcover_, Feb 10 2012, after Henry Bottomley *)","prog":"(Haskell)a003071 n = 1 - 2 ^ last es +   sum (zipWith (*) (zipWith (+) es [0..]) (map (2 ^) es))   where es = reverse $ a133457_row n-- _Reinhard Zumkeller_, Oct 28 2013","crossrefs":["Cf. A001855.","Cf. A133457."],"keyword":"nonn,easy,nice","offset":"1,3","author":"_N. J. A. Sloane_.","extensions":["More terms from _David W. Wilson_"]}