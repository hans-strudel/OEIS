{"formerly":"","seq":"1,1,1,1,1,2,2,1,3,2,2,3,1,2,2,3,2,1,2,2,3,2,2,1,2,1,2,2,1,4,3,4,5,3,1,2,3,2,3,5,4,1,2,3,4,2,3,4,3,3,4,4,3,3,4,3,2,4,3,2,4,4,3,4,4,5,3,4,4,2,4,4,4,5,5,3,3,4,1,1,3,2,4,3,3,3,1,3,2,2,3,4,2,1,1,3,2,3,5,3,4,3,3,2,4","description":"Primes embedded in prime(n) as substrings.","formula":"a(n) = A039997(prime(n)).a(n) <= A039994(n). - _Charles R Greathouse IV_, Apr 22 2015","example":"a(26) = 1 since the only prime substring of \"101\" is 101.","mathematica":"f[n_] := Block[{id = IntegerDigits@ Prime@n, len = Floor[ Log[10, Prime@n] + 1]}, Count[ PrimeQ@ Union[ FromDigits@# & /@ Flatten[ Table[ Partition[id, k, 1], {k, len}], 1]], True]]; Array[f, 105] (* _Robert G. Wilson v_, Jun 28 2010 *)","prog":"(PARI) dp(n)=if(n<12, return(if(isprime(n), [n], []))); my(v=vecsort(select(isprime, eval(Vec(Str(n)))), , 8), t); while(n>9, if(gcd(n%10, 10)>1, n\\=10; next); t=10; while((t*=10)<n*10, if(isprime(n%t), v=concat(v, n%t))); v=vecsort(v, , 8); n\\=10); va(n)=#dp(prime(n)) \\\\ _Charles R Greathouse IV_, Apr 22 2015","crossrefs":["Cf. A039994."],"keyword":"nonn,base","offset":"1,6","author":"_David W. Wilson_"}