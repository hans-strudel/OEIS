{"formerly":"M0510","seq":"1,2,3,4,5,6,9,8,7,10,17,12,33,18,11,16,65,14,129,20,19,34,257,24,13,66,15,36,513,22,1025,32,35,130,21,28,2049,258,67,40,4097,38,8193,68,23,514,16385,48,25,26,131,132,32769,30,37,72,259,1026,65537,44,131073,2050,39,64","description":"Inverse of the Doudna sequence A005940.","comments":"a(2^k) = 2^k. - _Robert G. Wilson v_, Feb 22 2005Fixed points: A029747. - _Reinhard Zumkeller_, Aug 23 2006","references":["J. H. Conway, personal communication.","N. J. A. Sloane and Simon Plouffe, The Encyclopedia of Integer Sequences, Academic Press, 1995 (includes this sequence)."],"links":["R. J. Mathar, <a href=\"/A005941/b005941.txt\">Table of n, a(n) for n=1,..,5000</a>","<a href=\"/index/Per#IntegerPermutation\">Index entries for sequences that are permutations of the natural numbers</a>"],"formula":"a(n) = h(g(n,1,1), 0) / 2 + 1 with h(n, m) = if n=0 then m else h(floor(n/2), 2*m + n mod 2) and g(n, i, x) = if n=1 then x else (if n mod prime(i) = 0 then g(n/prime(i), i, 2*x+1) else g(n, i+1, 2*x). - _Reinhard Zumkeller_, Aug 23 2006a(n) = 1 + A156552(n). - _Antti Karttunen_, Jun 26 2014","maple":"(Maple code from _R. J. Mathar_, Mar 06 2010)f := proc(n,i,x)option remember ;if n = 0 thenx;elif type(n,'even') thenprocname(n/2,i+1,x) ;elseprocname((n-1)/2,i,x*ithprime(i)) ;end if;end proc:A005940 := proc(n)f(n-1,1,1) ;end proc:A005941 := proc(n)local k ;for k from 1 doif A005940(k) = n thenreturn k;end if;end do ;end proc:","mathematica":"f[n_] := Block[{p = Partition[ Split[ Join[ IntegerDigits[n - 1, 2], {2}]], 2]}, Times @@ Flatten[ Table[q = Take[p, -i]; Prime[ Count[ Flatten[q], 0] + 1]^q[[1, 1]], {i, Length[p]}] ]]; t = Table[ f[n], {n, 10^5}]; Flatten[ Table[ Position[t, n, 1, 1], {n, 64}]] (* _Robert G. Wilson v_, Feb 22 2005 *)","prog":"(Scheme) (define (A005941 n) (+ 1 (A156552 n))) ;; _Antti Karttunen_, Jun 26 2014","crossrefs":["Cf. A103969. Inverse of A005940. One more than A156552."],"keyword":"nonn","offset":"1,2","author":"_N. J. A. Sloane_","extensions":["More terms from _Robert G. Wilson v_, Feb 22 2005","a(61) inserted by _R. J. Mathar_, Mar 06 2010"]}