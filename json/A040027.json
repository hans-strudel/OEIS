{"formerly":"","seq":"1,1,3,9,31,121,523,2469,12611,69161,404663,2512769,16485691,113842301,824723643,6249805129,49416246911,406754704841,3478340425563,30845565317189,283187362333331,2687568043654521,26329932233283223","description":"Second-from-right diagonal of triangle A121207.","comments":"Number of permutations beginning with 21 and avoiding 1-23. - _Ralf Stephan_, Apr 25 2004Originally defined as main diagonal of an array of binomial recurrence coefficients (see Gould).Starting (1, 3, 9, 31, 121,...) = row sums of triangle A153868. - _Gary W. Adamson_, Jan 03 2009Equals eigensequence of triangle A074909 (reflected). - _Gary W. Adamson_, Apr 10 2009The divergent series g(x=1,m) = 1^m*1! - 2^m*2! + 3^m*3! - 4^m*4! + ..., m=>-1, is related to the sequence given above. For m=-1 this series dates back to Euler. We discovered that g(x=1,m) = (-1)^m * (A040027(m) - A000110(m+1) * A073003) with A073003 Gompertz's constant and A000110 the Bell numbers, see A163940; A040027(m = -1) = 0. - _Johannes W. Meijer_, Oct 16 2009Compare the o.g.f. to the o.g.f. B(x) of the Bell nmumbers, where B(x) = 1 + x*B(x/(1-x))/(1-x). - _Paul D. Hanna_, Mar 23 2012a(n) is the number of set partitions of {1,2,...,n} in which the last block is a singleton: the blocks are arranged in order of their least element. An example is given below. - _Peter Bala_, Dec 17 2014","links":["Reinhard Zumkeller, <a href=\"/A040027/b040027.txt\">Table of n, a(n) for n = 0..500</a>","W. Asakly, A. Blecher, C. Brennan, A. Knopfmacher, T. Mansour, S. Wagner, <a href=\"http://dx.doi.org/10.1016/j.jmaa.2014.02.061\">Set partition asymptotics and a conjecture of Gould and Quaintance</a>, Journal of Mathematical Analysis and Applications, Volume 416, Issue 2, 15 August 2014, Pages 672-682.","Branko Dragovich, Andrei Yu. Khrennikov, Natasa Z. Misic, <a href=\"http://arxiv.org/abs/1508.05079\">Summation of p-Adic Functional Series in Integer Points</a>, arXiv:1508.05079 [math.NT], 2015.","B. Dragovich, N. Z. Misic, <a href=\"http://dx.doi.org/10.1134/S2070046614040025\">p-Adic invariant summation of some p-adic functional series</a>, P-Adic Numbers, Ultrametric Analysis, and Applications, October 2014, Volume 6, Issue 4, pp 275-283.","H. W. Gould and Jocelyn Quaintance, <a href=\"http://www.doiserbia.nb.rs/img/doi/1452-8630/2007/1452-86300702371G.pdf\">A linear binomial recurrence and the Bell numbers and polynomials</a>. Applicable Analysis and Discrete Mathematics, 1 (2007), 371-385.","R. K. Guy, <a href=\"/A002186/a002186.pdf\">Letters to N. J. A. Sloane, June-August 1968</a>","S. Kitaev, <a href=\"http://www.mat.univie.ac.at/users/slc/public_html/wpapers/s48kitaev.html\">Generalized pattern avoidance with additional restrictions</a>, Sem. Lothar. Combinat. B48e (2003).","S. Kitaev and T. Mansour, <a href=\"http://arXiv.org/abs/math.CO/0205182\">Simultaneous avoidance of generalized patterns</a>, arXiv:math/0205182 [math.CO], 2002."],"formula":"a(n) = b(n-2), n>1, b(n) = Sum_{k = 1..n} binomial(n, k-1)*b(n-k), b(0) = 1. - _Vladeta Jovovic_, Apr 28 2001E.g.f. satisfies A'(x) = exp(x)*A(x)+1. - _N. J. A. Sloane_With offset 0, e.g.f.: x + exp(exp(x)) * int[0..x, t*exp(-exp(t)+t) dt] (fits the recurrence up to n=215). - _Ralf Stephan_, Apr 25 2004Recurrence : a(1)=1, a(2)=1, for n>2, a(n)=n-1+sum(j=2, n-1, binomial(n-1, j)*a(j)) [gives a(n+1)]. - _Jon Perry_, Apr 26 2005O.g.f. satisfies: A(x) = 1 + x*A( x/(1-x) ) / (1-x)^2. - _Paul D. Hanna_, Mar 23 2012From _Peter Bala_, Dec 17 2014: (Start)Starting from A(x) = 1 + O(x) (big Oh notation) we can get a series expansion for the o.g.f. by repeatedly applying the above functional equation of Hanna: A(x) = 1 + O(x) = 1 + x/(1-x)^2 + O(x^2) = 1 + x/(1-x)^2 + x^2/((1-x)*(1-2*x)^2) + O(x^3) = ... = 1 + x/(1-x)^2 + x^2/((1-x)*(1-2*x)^2) + x^3/((1-x)*(1-2*x)*(1-3*x)^2) + x^4/((1-x)*(1-2*x)*(1-3*x)*(1-4*x)^2) + ....a(n) = sum {k = 0..n} ( sum {j = k..n} Stirling2(j,k)*k^(n-j) ).Row sums of A108458. First column of A124496. (End)","example":"a(4) = 9: Arranging the blocks of the 15 set partitions of {1,2,3,4} in order of their least element we find 9 set partitions for which the last block is a singleton, namely, 123|4, 124|3, 134|2, 1|24|3, 1|23|4, 12|3|4, 13|2|4, 14|2|3, and 1|2|3|4. - _Peter Bala_, Dec 17 2014","maple":"A040027 := proc(n)    option remember;    if n = 0 then        1;    else        add(binomial(n,k-1)*procname(n-k),k=1..n) ;    end if;end proc: # _Johannes W. Meijer_, Oct 16 2009","mathematica":"a[0] = a[1] = 1; a[n_] := a[n] = Sum[Binomial[n, k + 1]*a[k], {k, 0, n - 1}]; Table[a[n], {n, 0, 22}]  (* _Jean-Fran√ßois Alcover_, Jul 02 2013 *)Rest[CoefficientList[Assuming[Element[x, Reals], Series[E^E^x*(ExpIntegralEi[-E^x] - ExpIntegralEi[-1]), {x, 0, 20}]], x] * Range[0, 20]!] (* _Vaclav Kotesovec_, Feb 28 2014 *)","prog":"(PARI) {a(n)=local(A=1+x);for(i=1,n,A=1+x*subst(A,x,x/(1-x+x*O(x^n)))/(1-x)^2);polcoeff(A,n)} /* _Paul D. Hanna_, Mar 23 2012 */(Haskell)a040027 n = head $ a046936_row (n + 1)  -- _Reinhard Zumkeller_, Jan 01 2014(Python)# The function Gould_diag is defined in A121207.A040027_list = lambda size: Gould_diag(2, size)print(A040027_list(24)) # _Peter Luschny_, Apr 24 2016","crossrefs":["Left-hand border of triangle A046936.","Cf. A153868. - _Gary W. Adamson_, Jan 03 2009","Cf. A074909. - _Gary W. Adamson_, Apr 10 2009","Row sums of A163940. - _Johannes W. Meijer_, Oct 16 2009","Cf. A108458 (row sums), A124496 (column 1)."],"keyword":"easy,nonn,nice","offset":"0,3","author":"_Henry Gould_","extensions":["Entry revised by _N. J. A. Sloane_, Dec 11 2006","Gould reference updated by _Johannes W. Meijer_, Aug 02 2009"]}